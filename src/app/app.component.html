<link href='https://fonts.googleapis.com/css?family=Great Vibes' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
<p-toast />
<p-confirmDialog />
<div class="invitation-page">
  <div class="custom-container">
    <img src="assets/greece-flag-15.gif" alt="Flag" class="flag">
    <nav>
      <a href="#section1" (click)="scrollToSection($event, 'section1')">Organizacja</a>
      <a href="#section2" (click)="scrollToSection($event, 'section2')">Harmonogram</a>
      <a href="#section3" (click)="scrollToSection($event, 'section3')">Formularz</a>
    </nav>
  </div>
  <div class="cover">
    <img [src]="screenWidth > 500 ? desktopImg : mobileImg" alt="Logo">
  </div>
  <div class="h1 written-text">Pobieramy się!</div>
  <div class="date">09.05.2025</div>
  <div class="countdown-container">
    <div class="h2">Do ślubu zostało:</div>
    <div class="countdown-area">
      <div class="countdown">
        <div class="orange-rectangle">{{ countdown?.days }} dni</div>
        <div class="countdown-segment">
          <span class="countdown-number">{{ countdown!.hours > 9 ? countdown?.hours : '0' + countdown?.hours }}</span>
        </div>
        <div class="countdown-colon">:</div>
        <div class="countdown-segment">
          <span class="countdown-number">{{ countdown!.minutes > 9 ? countdown?.minutes : '0' + countdown?.minutes }}</span>
        </div>
        <div class="countdown-colon">:</div>
        <div class="countdown-segment">
          <span class="countdown-number">{{ countdown!.seconds > 9 ? countdown?.seconds : '0' + countdown?.seconds }}</span>
        </div>
      </div>
    </div>
  </div>
  <div class="description">
    Mamy zaszczyt zaprosić Was na nasze wesele, które odbędzie się w pięknej Grecji.
    <br><br>
    Będzie nam niezmiernie miło gościć Was w tym wyjątkowym dniu!
  </div>
  <div class="video" [innerHtml]="safeUrl"></div>

  <div id="section1" class="section location">
    <div class="h2">Organizacja</div>
    <div class="location-content">
      <div class="location-list">
        <div *ngFor="let item of mapItems" class="map-card" (click)="onItemSelect(item)">
          <div [style.background-image]="'url(' + item.icon + ')'" class="map-card-image"></div>
          <div class="h2">{{ item.name }}</div>
          <div class="extension">{{ item.extension }}</div>
          <div class="description">{{ item.description }}</div>
          <a *ngIf="item.address" [href]="item.google" class="description" target="_blank">{{ item.address }}</a>
          <a *ngIf="item.url" [href]="item.url" class="map-card-link" target="_blank">Zobacz szczegóły</a>
        </div>
      </div>
      <div class="location-map">
        <app-map-component [selectedItem]="selectedLocation | async"></app-map-component>
      </div>
    </div>
  </div>
  
  <div id="section2" class="section schedule">
    <div class="h2">Harmonogram</div>
    <div class="custom-card">
      <p-timeline [value]="events" [align]="timelineAlign" styleClass="customized-timeline">
          <ng-template pTemplate="marker" let-event>
              <span class="custom-marker shadow-2" [style.backgroundColor]="event.color">
                  <span class="material-symbols-outlined">{{ event.icon }}</span>
              </span>
          </ng-template>
          <ng-template pTemplate="content" let-event>
              <p-card [header]="event.status" [subheader]="event.date">
                  <img *ngIf="event.image" [src]="'assets/' + event.image" [alt]="event.name" [width]="imgWidth" />
                  <p *ngIf="event.text" style="padding-top: 20px; margin-bottom: 0;">
                      {{ event.text }}
                  </p>
              </p-card>
          </ng-template>
      </p-timeline>
  </div>
    
</div>
  <div class="bottom-right-corner">
    <p-knob [(ngModel)]="presentCount" valueColor="#0047AB" [readonly]="true" [max]="userCount"></p-knob>
    <div class="text">Zgłoszeni goście</div>
  </div>
  <div id="section3" class="section form">
    <form [formGroup]="userForm" (ngSubmit)="confirm()">
      <div class="p-fluid">
        <div class="h2">Formularz</div>
        <div class="description">Drodzy Goście, bardzo prosimy o potwierdzenie przybycia do dnia <u>07.02.2025 r</u>. Aby ułatwić Wam potwierdzenie przybycia, przygotowaliśmy dla Was poniższy formularz. Dziękujemy za wypełnienie go <br>i mamy nadzieję do zobaczenia!</div>
        <div style="margin-top: 10px;" class="p-field-radiobutton">
          <div for="presence">Obecność</div>
          <p-radioButton name="presence" value="true" formControlName="presence" label="Będę!"></p-radioButton>
          <p-radioButton name="presence" value="false" formControlName="presence" label="Niestety nie mogę 😢"></p-radioButton>
        </div>
        <div class="p-field">
          <label for="name">Imię</label>
          <input id="name" type="text" pInputText class="form-control" formControlName="name" maxlength="30" pKeyFilter="alpha" [ngClass]="{'is-invalid': userForm.get('name')?.touched && userForm.get('name')?.invalid}">
          <span *ngIf="userForm.get('name')?.touched && userForm.get('name')?.hasError('required')" class="invalid-feedback">
            Pole obowiązkowe.
          </span>
          <span *ngIf="userForm.get('name')?.touched && userForm.get('name')?.hasError('minlength')" class="invalid-feedback">
            Zbyt krótkie imię.
          </span>
        </div>
        <div class="p-field">
          <label for="surname">Nazwisko</label>
          <input id="surname" type="text" pInputText class="form-control" formControlName="surname" maxlength="30" pKeyFilter="alpha" [ngClass]="{'is-invalid': userForm.get('surname')?.touched && userForm.get('surname')?.invalid}">
          <span *ngIf="userForm.get('surname')?.touched && userForm.get('surname')?.hasError('required')" class="invalid-feedback">
            Pole obowiązkowe.
          </span>
          <span *ngIf="userForm.get('surname')?.touched && userForm.get('surname')?.hasError('minlength')" class="invalid-feedback">
            Zbyt krótkie nazwisko.
          </span>
        </div>
        <div class="p-field">
          <label for="phoneNumber">Telefon</label>
          <input type="text" pInputText formControlName="phoneNumber" pKeyFilter="pint" maxlength="13" [ngClass]="{'is-invalid': userForm.get('phoneNumber')?.touched && userForm.get('phoneNumber')?.invalid}">
          <span *ngIf="userForm.get('phoneNumber')?.touched && userForm.get('phoneNumber')?.hasError('required')" class="invalid-feedback">
            Pole obowiązkowe.
          </span>
          <span *ngIf="userForm.get('phoneNumber')?.touched && userForm.get('phoneNumber')?.hasError('minLength')" class="invalid-feedback">
            Zbyt krótki numer.
          </span>
        </div>
        <div class="p-field">
          <label for="allergies">Alergie</label>
          <input id="allergies" type="text" placeHolder="Laktoza, bakłażan" pInputText maxlength="100" formControlName="allergies">
        </div>
        <div class="p-field-radiobutton">
          <div for="menuPreference">Preferencje menu</div>
          <p-radioButton name="menuPreference" value="any" formControlName="menuPreference" label="Obojętne"></p-radioButton>
          <p-radioButton name="menuPreference" value="vegetarian" formControlName="menuPreference" label="Wegetariańskie"></p-radioButton>
          <p-radioButton name="menuPreference" value="vege" formControlName="menuPreference" label="Wege"></p-radioButton>
          <p-radioButton name="menuPreference" value="meat" formControlName="menuPreference" label="Mięsne"></p-radioButton>
        </div>
        <div class="p-field">
          <label for="message">Wiadomość</label>
          <textarea id="message" formControlName="message" rows="5" placeHolder="Będzie super, nie mogę się doczekać! :)" maxlength="300" pInputTextarea></textarea>
        </div>
        
        <button type="submit" pButton label="Wyślij" [disabled]="!userForm.valid"></button>
        
      </div>
    </form>
    
  </div>
</div>
